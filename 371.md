## PE 371

~~我数学不好只能写假算法怎么办啊~~

保留$8$位小数那么显然这些字母就没什么用了

并且我们可以意识到，在看到很多的车之后还不满足条件的可能性是很小的

那么我们设$dp_{i,j,0/1}$ 表示现在看到了$i$辆车，$j$种不同的非零数字，是否出现过$500$

愉快转移即可

``` c++
#include<bits/stdc++.h>
using namespace std;
typedef long long ll;
const int N=1000+5;
double dp[2][505][2],ans;
int main(){
	dp[0][0][0]=1.0;
	int now=0;
	for (int i=0;i<=N;++i){
		for (int j=0;j<=i && j<=500;++j){
			ans+=(dp[now][j][0]+dp[now][j][1])*((double)j/1000.0)*(double)(i+1);
			dp[now^1][j][0]+=dp[now][j][0]*((double)(j+1)/1000.0);
			dp[now^1][j][1]+=dp[now][j][1]*((double)j/1000.0);
			dp[now^1][j+1][0]+=dp[now][j][0]*((double)(1000-j-j-2)/1000.0);
			dp[now^1][j+1][1]+=dp[now][j][0]/1000.0;
			dp[now^1][j+1][1]+=dp[now][j][1]*((double)(1000-j-j)/1000.0);
		}
		for (int j=0;j<=i && j<=500;++j) dp[now][j][1]=dp[now][j][0]=0.0;
		now^=1;
	}
	printf("%.8lf\n",ans);
	return 0;
}
```

